---
import { getCollection } from "astro:content"
import Course from "../../layouts/Course.astro"
import type { Lesson } from "../../types/Course"

const { slug } = Astro.params

const lessons: (Lesson & { render: any })[] = await getCollection("course")
const currentLessonIndex = lessons.findIndex(lesson => lesson.slug === slug)
const currentLesson = lessons[currentLessonIndex]

if (!currentLesson) return Astro.redirect('/course')

const prevLesson = lessons[currentLessonIndex - 1]
const nextLesson = lessons[currentLessonIndex + 1]

export const prerender = false
const { Content } = await currentLesson.render()
---

<Course
	previousLesson={prevLesson}
	nextLesson={nextLesson}
	slug={currentLesson.slug}
	{...currentLesson.data}
>
	<Content />
</Course>
